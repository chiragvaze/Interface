<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Multi-Medicine Prescription Form</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
        /* Additional styles for the new prescription system */
        .medicine-list {
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #f9f9f9;
        }
        
        .medicine-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .medicine-info {
            flex: 1;
        }
        
        .remove-medicine {
            background-color: #ff4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .remove-medicine:hover {
            background-color: #cc0000;
        }
        
        .add-medicine-btn {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 0;
        }
        
        .submit-prescription-btn {
            background-color: #2196F3;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px 0;
        }
        
        .prescription-history-item {
            margin: 15px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .prescription-summary {
            background-color: #f5f5f5;
            padding: 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .prescription-details {
            padding: 15px;
            background-color: white;
            border-top: 1px solid #ddd;
        }
        
        .dropdown-icon {
            transition: transform 0.3s;
        }
        
        .dropdown-icon.rotated {
            transform: rotate(180deg);
        }
        
        .medicine-detail {
            margin: 10px 0;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="d1">
        <img src="./image/sample-profile-photo2.jpg" alt="profile image" class="profile-image" />
        <div class="text-content">
            <h1 class="name">Chirag Vaze</h1>
            <div class="gen">
                <p class="gender">M</p>
            </div>
            <p class="age">Age - 19</p>
        </div>
    </div>
    <div class="container">
        <div class="sec1">
            <h2>Prescription Form</h2>
            <form id="prescriptionForm">
                <!-- Medicine Selection -->
                <div class="form-group">
                    <label for="medicine">Medicine:</label>
                    <select id="medicine" name="medicine" required>
                        <option value="">Select a medicine</option>
                        <option value="paracetamol">Paracetamol</option>
                        <option value="ibuprofen">Ibuprofen</option>
                        <option value="amoxicillin">Amoxicillin</option>
                        <option value="omeprazole">Omeprazole</option>
                        <option value="loratadine">Loratadine</option>
                        <option value="aspirin">Aspirin</option>
                        <option value="metformin">Metformin</option>
                        <option value="atorvastatin">Atorvastatin</option>
                        <option value="lisinopril">Lisinopril</option>
                        <option value="salbutamol">Salbutamol</option>
                    </select>
                </div>
                
                <!-- Dosage -->
                <div class="form-group">
                    <label for="dosage">Dosage:</label>
                    <input type="text" id="dosage" name="dosage" placeholder="e.g., 500mg" required>
                </div>
                
                <!-- Duration -->
                <div class="form-group">
                    <label for="duration">Duration:</label>
                    <input type="text" id="duration" name="duration" placeholder="e.g., 7 days" required>
                </div>
                
                <!-- Frequency -->
                <div class="form-group">
                    <label>Frequency:</label>
                    <div class="frequency-buttons">
                        <button type="button" class="freq-btn" data-frequency="morning">Morning</button>
                        <button type="button" class="freq-btn" data-frequency="afternoon">Afternoon</button>
                        <button type="button" class="freq-btn" data-frequency="evening">Evening</button>
                        <button type="button" class="freq-btn" data-frequency="night">Night</button>
                    </div>
                    <input type="hidden" id="frequency" name="frequency">
                </div>
                
                <!-- Timing -->
                <div class="form-group">
                    <label>Timing:</label>
                    <div class="timing-buttons">
                        <button type="button" class="timing-btn" data-timing="before-breakfast">Before Breakfast</button>
                        <button type="button" class="timing-btn" data-timing="after-breakfast">After Breakfast</button>
                        <button type="button" class="timing-btn" data-timing="before-lunch">Before Lunch</button>
                        <button type="button" class="timing-btn" data-timing="after-lunch">After Lunch</button>
                        <button type="button" class="timing-btn" data-timing="before-dinner">Before Dinner</button>
                        <button type="button" class="timing-btn" data-timing="after-dinner">After Dinner</button>
                    </div>
                    <input type="hidden" id="timing" name="timing">
                </div>
                
                <!-- Instructions -->
                <div class="form-group">
                    <label for="instructions">Instructions:</label>
                    <textarea id="instructions" name="instructions" rows="3" placeholder="Additional instructions for the patient"></textarea>
                </div>
                
                <!-- Notes -->
                <div class="form-group">
                    <label for="notes">Notes:</label>
                    <textarea id="notes" name="notes" rows="2" placeholder="Additional notes"></textarea>
                </div>
                
                <!-- Action Buttons -->
                <div class="form-group">
                    <button type="button" class="add-medicine-btn" onclick="addMedicineToPrescription()">Add Medicine to List</button>
                </div>
            </form>
            
            <!-- Current Medicine List -->
            <div id="medicineListSection" style="display: none;">
                <h3>Current Prescription Medicines</h3>
                <div id="currentMedicineList"></div>
                <button type="button" class="submit-prescription-btn" onclick="submitPrescription()">Submit Prescription</button>
            </div>
        </div>
        
        <div class="sec2">
            <h2>Prescription History</h2>
            <div id="prescriptionHistoryList"></div>
        </div>
        
        <div class="sec3">
            <p class="bio">Diseases</p>
        </div>
    </div>

    <script>
        // Prescription history array
        let prescriptionHistory = [];
        let currentPrescription = {
            medicines: [],
            date: new Date(),
            id: Date.now()
        };
        
        // Function to add medicine to current prescription
        function addMedicineToPrescription() {
            const medicine = document.getElementById('medicine').value;
            const dosage = document.getElementById('dosage').value;
            const duration = document.getElementById('duration').value;
            const frequency = document.getElementById('frequency').value;
            const timing = document.getElementById('timing').value;
            const instructions = document.getElementById('instructions').value;
            const notes = document.getElementById('notes').value;
            
            if (!medicine || !dosage || !duration) {
                alert('Please fill in medicine, dosage, and duration');
                return;
            }
            
            const medicineObj = {
                id: Date.now() + Math.random(),
                medicine: medicine,
                dosage: dosage,
                duration: duration,
                frequency: frequency,
                timing: timing,
                instructions: instructions,
                notes: notes
            };
            
            currentPrescription.medicines.push(medicineObj);
            displayCurrentMedicineList();
            
            // Reset form
            document.getElementById('medicine').value = '';
            document.getElementById('dosage').value = '';
            document.getElementById('duration').value = '';
            document.getElementById('frequency').value = '';
            document.getElementById('timing').value = '';
            document.getElementById('instructions').value = '';
            document.getElementById('notes').value = '';
            
            // Reset button active states
            document.querySelectorAll('.freq-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.timing-btn').forEach(btn => btn.classList.remove('active'));
        }
        
        // Function to display current medicine list
        function displayCurrentMedicineList() {
            const medicineList = document.getElementById('currentMedicineList');
            medicineList.innerHTML = '';
            
            currentPrescription.medicines.forEach((med, index) => {
                const medicineItem = document.createElement('div');
                medicineItem.className = 'medicine-item';
                medicineItem.innerHTML = `
                    <div class="medicine-info">
                        <strong>${med.medicine}</strong> - ${med.dosage} for ${med.duration}
                        ${med.frequency ? `<br><small>Frequency: ${med.frequency}</small>` : ''}
                        ${med.timing ? `<br><small>Timing: ${med.timing}</small>` : ''}
                    </div>
                    <button type="button" class="remove-medicine" onclick="removeMedicine(${index})">Remove</button>
                `;
                medicineList.appendChild(medicineItem);
            });
            
            const medicineListSection = document.getElementById('medicineListSection');
            if (currentPrescription.medicines.length > 0) {
                medicineListSection.style.display = 'block';
            } else {
                medicineListSection.style.display = 'none';
            }
        }
        
        // Function to remove medicine from current prescription
        function removeMedicine(index) {
            currentPrescription.medicines.splice(index, 1);
            displayCurrentMedicineList();
        }
        
        // Function to submit entire prescription
        function submitPrescription() {
            if (currentPrescription.medicines.length === 0) {
                alert('Please add at least one medicine to the prescription');
                return;
            }
            
            const prescription = {
                id: Date.now(),
                medicines: [...currentPrescription.medicines],
                date: new Date(),
                prescriptionNumber: `RX-${Date.now().toString().slice(-6)}`
            };
            
            prescriptionHistory.push(prescription);
            displayPrescriptionInHistory(prescription);
            
            // Reset current prescription
            currentPrescription = {
                medicines: [],
                date: new Date(),
                id: Date.now()
            };
            
            displayCurrentMedicineList();
        }
        
        // Function to display prescription in history section
        function displayPrescriptionInHistory(prescription) {
            const historySection = document.getElementById('prescriptionHistoryList');
            
            const dateObj = prescription.date;
            const dateStr = dateObj.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
            const timeStr = dateObj.toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            const prescriptionElement = document.createElement('div');
            prescriptionElement.className = 'prescription-history-item';
            prescriptionElement.innerHTML = `
                <div class="prescription-summary" onclick="togglePrescriptionDetails(${prescription.id})">
                    <div class="prescription-header">
                        <h3>Prescription ${prescription.prescriptionNumber}</h3>
                        <span class="prescription-date">${dateStr} at ${timeStr}</span>
                    </div>
                    <div class="prescription-preview">
                        ${prescription.medicines.length} medicine(s) prescribed
                    </div>
                    <div class="dropdown-icon">▼</div>
                </div>
                <div class="prescription-details" id="details-${prescription.id}" style="display: none;">
                    <div class="medicine-list">
                        ${prescription.medicines.map(med => `
                            <div class="medicine-detail">
                                <h4>${med.medicine}</h4>
                                <p><strong>Dosage:</strong> ${med.dosage}</p>
                                <p><strong>Duration:</strong> ${med.duration}</p>
                                ${med.frequency ? `<p><strong>Frequency:</strong> ${med.frequency}</p>` : ''}
                                ${med.timing ? `<p><strong>Timing:</strong> ${med.timing}</p>` : ''}
                                ${med.instructions ? `<p><strong>Instructions:</strong> ${med.instructions}</p>` : ''}
                                ${med.notes ? `<p><strong>Notes:</strong> ${med.notes}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            historySection.appendChild(prescriptionElement);
        }
        
        // Function to toggle prescription details
        function togglePrescriptionDetails(prescriptionId) {
            const detailsElement = document.getElementById(`details-${prescriptionId}`);
            const dropdownIcon = document.querySelector(`[onclick="togglePrescriptionDetails(${prescriptionId})"] .dropdown-icon`);
            
            if (detailsElement.style.display === 'none') {
                detailsElement.style.display = 'block';
                dropdownIcon.textContent = '▲';
                dropdownIcon.classList.add('rotated');
            } else {
                detailsElement.style.display = 'none';
                dropdownIcon.textContent = '▼';
                dropdownIcon.classList.remove('rotated');
            }
        }
        
        // Event listeners for frequency and timing buttons
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.freq-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const frequencyInput = document.getElementById('frequency');
                    let values = frequencyInput.value.split(',').filter(v => v.trim());
                    const freq = this.getAttribute('data-frequency');
                    
                    if (this.classList.contains('active')) {
                        if (!values.includes(freq)) values.push(freq);
                    } else {
                        values = values.filter(v => v !== freq);
                    }
                    
                    frequencyInput.value = values.join(', ');
                });
            });
            
            document.querySelectorAll('.timing-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.timing-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById('timing').value = this.getAttribute('data-timing');
                });
            });
        });
    </script>
</body>
</html>